\documentclass{article}


\usepackage{amsmath}
\usepackage{amssymb}
\input{theorem}

\input{prooftree}
\def\erule#1#2{\begin{prooftree}#1\justifies #2\end{prooftree}}

\usepackage{tikz}
\usepackage{tikz-cd}
\definecolor{green}{HTML}{007f00}
\definecolor{cyan}{HTML}{007f7f}
\definecolor{purple}{HTML}{af00af}
\def\rr#1{{\color{red}\mathbf {#1}}}
\def\bb#1{{\color{blue}\mathbf{#1}}}
\def\Z{\mathcal Z}
\def\adjust{\big|}
\def\O{\mathcal{O}}
\def\rid{\mathsf{id}}
\def\int{\square}
\def\bd{\partial}
\def\prov{\vdash}
\def\prequiv{\dashv\vdash}
\def\imp{\Rightarrow}
\def\cqed{\hskip2mm{\vrule width .5em height .5em depth 0em}} % at the end of a |P.
\def\o{\circ}
\def\N{\mathbb{N}}
\def\R{\mathbb{R}}
\def\x{\times}
\def\st{\mathrel|}
\def\rset{\mathbf{Set}}
\def\op{\mathsf{op}}
\def\P{\mathbf{P}}
\def\dash{\hbox{---}}
\def\deg{\mathop{\mathsf{deg}}}
\def\celse{\mathrel{|}}
\def\cn{{:}}
\def\rok{\mathrel\mathsf{ok}}
\def\sub{\subseteq}



\title{Categorifying the BCH Formula}
\begin{document}
\maketitle
\tikzset{
   commutative diagrams/.cd,
   arrow style=tikz,
   diagrams={>=stealth}}
\section{Baker-Campbell-Hausdorff in a Semiring}

The goal of this note is to state and prove a version of the Baker-Campbell-Hausdorff formula
in an arbitrary (not necessarily commutative) semiring, that is a set $R$ with $(+,0,\cdot,1)$,
where $+$ is required to be commutative but $\cdot$ is not, with $\cdot$ distributing over $+$,
and all the other usual laws.

The Baker-Campbell-Hausdorff formula says that if we seek $G_1, G_2, \ldots$ such that
\[ e^{tA} e^{tB} = e^{tG_1 + t^2G_2 + t^3G_3 + \cdots}\]
holds, we find that we must set $G_1 = A + B$, and $G_2 = [A,B]/2$, and $G_3 = [A,[A,B]]/12 + [B,[B,A]]/12$,
and so on.

The barriers to interpreting this in a semiring are the concepts of
the exponentiation function, (which involves division in its coefficients, the division
in the coefficients of the Lie brackets occurring the right-hand side, and the
 subtractions occurring because of the Lie brackets themselves.

\subsection{Exponentials}
To deal with the exponentials we differentiate both sides $n$ times by $t$, and set $t = 0$.
\subsubsection{Left Side}
On the left, we see
\[ e^{tA} e^{tB}
=  \sum_{m=0}^{\infty} \sum_{p = 0}^\infty {t^mA^m\over m!}{t^pB^p\over p!}\]
\[=  \sum_{m=0}^{\infty} \sum_{p = 0}^\infty t^{m+p}{A^mB^p\over m!p!}\]
\[=  \sum_{m=0}^{\infty} t^{m} \sum_{p = 0}^m {A^pB^{m-p}\over p!(m-p)!}\]
so
\[\left(\partial \over \partial t\right)^n e^{tA} e^{tB}\Bigg|_{t=0}
=  \left(\sum_{m=n}^{\infty} t^{m-n}{m!\over (m-n)!}\sum_{p = 0}^m {A^pB^{m-p}\over p!(m-p)!}\right)\Bigg|_{t=0}\]
\[= \sum_{p = 0}^n {n\choose p} A^pB^{n-p} \]

Notice that if we define $\Z[X] = AX + XB$,
then this expression is just $\Z^n[1]$.

\subsubsection{Right Side}
A {\em composition} of $n$ with $k$ parts is a sequence
$\lambda = \lambda(1),\ldots,\lambda(k)$ with every $\lambda(i) \ge 1$.
We consider there to be exactly one composition $\emptyset$ of $0$, with $0$ parts.
Let $C_n$ be the set of compositions of $n$. We write $|\lambda|$
for the number of parts of $\lambda$.

If we define
\[G_\lambda = \prod_{i = 1}^{|\lambda|} G_{\lambda(i)}\]
(noting that $G_\emptyset = 1$) then we can reason
\[ \exp\left(\sum_{m = 1}^\infty t^mG_m \right) = \sum_{k=0}^\infty {1\over k!}\left(\sum_{m = 1}^\infty t^mG_m \right)^k\]
\[= \sum_{m=0}^\infty \sum_{\lambda \in C_m}{t^m\over |\lambda|!}G_\lambda\]
so
\[\left(\partial \over \partial t\right)^n \exp\left(\sum_{m = 1}^\infty t^mG_m \right)\Bigg|_{t=0} =
\left( \sum_{m=n}^\infty \sum_{\lambda \in C_m}{t^{m-n}m!\over (m-n)!|\lambda|!}G_\lambda\right)\Bigg|_{t=0}
\]
\[=  \sum_{\lambda \in C_n}{n!\over |\lambda|!}G_\lambda\]

\subsubsection{Together}
Define \[X_n =  \sum_{\lambda \in C_n}{n!\over |\lambda|!}G_\lambda\]
The problem BCH poses is to find $G_i$ such that, for every $n \ge 0$,
\[\Z^n[1] = X_n\]
Note that already this equation by itself makes sense in an arbitrary semiring, since ${n!/|\lambda|!}$ is always
an integer. We now need to account for the fact that the {\em solution} to this problem,
i.e. the sequence of values $G_1, G_2, \ldots$, necessarily involves division and subtraction in the
usual formulation.
\subsection{Subtraction and Division of Lie Brackets}

Instead of using subtraction and division directly, we simply ask for solutions to particular equations
in a semiring which imply subtraction and division indirectly. Much like how particular cartesian
products may or may not exist in a category, we define what it means for a semiring element
to `be a fractional Lie bracket' of two other semiring elements.

\begin{definition}
Suppose $a, b, c\in R$. We say $c$ a Lie bracket of $a,b$ (i.e. ``$c = [a,b]$'')
if $c + ba = ab$.
\end{definition}


Let $C^+_n$ be the set extended compositions of $n$. An extended composition of weight
$n$ can also be $0,\lambda$ where $\lambda$ is a composition of weight $n-1$.
Let
\[D^k_n = \{\lambda \in C^+_n \st |\lambda| \ge k\} \qquad D^k = \bigcup_{n} D^k_n\]



\begin{definition}
 A {\em candidate} for $a,b$ is a sequence $(G_n \in R)_{n\in \N} $ and
a map $G_{[\dash]}: D^1 \to R$, such that
\begin{enumerate}
\item $G_0 = a$ and $G_1 = a + b$
\item $G_{[n]} = G_n$ for every $n$
\item $ G_{[\lambda, n]}$ is a Lie bracket of $G_{[\lambda]}, G_n$ for all $n\in \N,\lambda\in D^1$
\end{enumerate}
\end{definition}


\begin{definition}
A  map $c : D^2 \to \N$ {\em is a solution to the BCH problem} if
for every $a,b\in R$, we have that every candidate $G,f$ for $a,b$ that satisfies
\[\forall n\ge 2 .\left( n! G_n = \sum_{\lambda\in D^2_n} c(\lambda) G_{[\lambda]}\right)\]
also satisfies
\[\forall n .\left( \Z_{ab}^n[1] = \sum_{\lambda \in C_n}{n!\over |\lambda|!}G_\lambda\right)\]
\end{definition}

\end{document}
