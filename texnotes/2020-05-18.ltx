\documentclass{article}
\usepackage{amssymb}
\input{theorem}

\input{prooftree}
\def\erule#1#2{\begin{prooftree}#1\justifies #2\end{prooftree}}
\def\pair#1#2{\langle #1 , #2 \rangle}

\usepackage{tikz}
\usepackage{tikz-cd}
\usetikzlibrary{calc}
\definecolor{morange}{rgb}{1,0.56,0}
\definecolor{lorange}{rgb}{1,0.95,0.8}
\definecolor{mgreen}{rgb}{0,0.56,0}
\definecolor{lgreen}{rgb}{0.95,1,0.8}
\definecolor{mblue2}{rgb}{0,0.2,1.0}
\definecolor{lblue}{rgb}{0.8,0.95,1}
\definecolor{mred}{rgb}{0.9,0.1,0.1}
\definecolor{mgreen}{rgb}{0.1,0.5,0.1}
\definecolor{mblue}{rgb}{0.3,0.3,0.9}
\def\bitf#1{#1 [smooth, tension=0.8] coordinates {(-1.6,2) (-1,1) (0,0)}}
\def\bitg#1{#1 [smooth, tension=0.8] coordinates {(1,2) (0.55,1) (0,0)}}
\def\bitgrev#1{#1 [smooth, tension=0.8] coordinates {(0,0) (0.55,1) (1,2)}}
\def\bitfg#1{#1 [smooth, tension=0.8] coordinates {(0,0) (0,-2) }}
\def\ep{\varepsilon}
\def\bcase{\mathop\mathbf{case}}
\def\bof{\mathop\mathbf{of}}
\def\binj{\mathbf{inj}}
\def\blet{\mathrel\mathbf{let}}
\def\bin{\mathrel\mathbf{in}}
\def\bmatch{\mathrel\mathbf{match}}
\def\bwith{\mathrel\mathbf{with}}
\def\pbck{\ar[dr, phantom, pos=0, "\lrcorner"]}
\def\ups{{\uparrow}}
\def\dns{{\downarrow}}
\def\grad{\nabla}
\def\uups{{\Uparrow}}
\def\ddns{{\Downarrow}}
\def\adjust{\big|}
\def\O{\mathcal{O}}
\def\rid{\mathsf{id}}
\def\ridp{\mathsf{idp}}
\def\rcoe{\mathsf{coe}}
\def\rtype{\mathsf{type}}
%\def\int{\square}
\def\bd{\partial}
\def\prov{\vdash}
\def\prequiv{\dashv\vdash}
\def\imp{\Rightarrow}
\def\cqed{\hskip2mm{\vrule width .5em height .5em depth 0em}} % at the end of a |P.
\def\o{\circ}
\def\lx{\bigcirc}
\def\B{\mathbb{B}}
\def\C{\mathbf{C}}
\def\R{\mathbb{R}}
\def\bx{\mathbf{x}}
\def\by{\mathbf{y}}
\def\bv{\mathbf{v}}
\def\bt{\mathbf{t}}
\def\bu{\mathbf{u}}
\def\bp{\mathbf{p}}
\def\bz{\mathbf{0}}
\def\bzee{\mathbf{z}}
\def\S{\mathfrak{S}}
\def\M{\mathbb{M}}
\def\X{\mathbf{X}}
\def\Y{\mathcal{Y}}
\def\x{\times}
\def\st{\mathrel|}
\def\rset{\mathbf{Set}}
\def\rcat{\mathbf{Cat}}
\def\op{\mathsf{op}}
\def\P{\mathbb{P}}
\def\I{\mathbb{I}}
\def\U{\mathbb{U}}
\def\N{\mathbb{N}}
\def\Z{\mathbb{Z}}
\def\tw{\mathbf{2}}
\def\dash{\hbox{---}}
\def\dom{\mathop{\mathrm{dom}}}
\def\cod{\mathop{\mathrm{cod}}}
\def\celse{\mathrel{|}}
\def\cn{{:}}
\def\rok{\mathrel\mathsf{ok}}
\def\llam#1{\langle {#1} \rangle}
\def\hf{{\odot}}
\def\lerp#1#2#3{#1[\![#2,#3]\!]}
\def\nope{\emptyset}
\def\ep{\varepsilon}
\def\rng{\mathop\mathrm{rng}}
\def\npart{\not\!\partial}
\def\null{\emptyset}

\begin{document}
\tikzset{>=stealth}
\tikzset{
   commutative diagrams/.cd,
   arrow style=tikz,
   diagrams={>=stealth}}

\section{Main}

Consider a category $\I$ whose objects are closed intervals in the
reals, and whose morphisms are monotone continuous maps.

We attempt to define a Grothendieck topology on this category by
saying that a sieve $S$ on an interval $X = [a,b]$ is covering iff the union of the ranges
of the maps in $S$ is the whole interval $[a,b]$.

\[ \hom(\dash, X) \supseteq S  \in J(X) \iff X = \bigcup_{g : Z \to X \in S} \rng g \]
\[  \iff \forall x \in X . \exists Z . \exists g : Z \to X \in S . \exists z \in Z . g(z) = x\]

To check this is a Grothendieck topology, we check:

\begin{enumerate}
\item ({\bf Change of Base}) If $S \in J(X)$, and $f : Y \to X$, then $f^* S \in J(Y)$.
Let $S \in J(X)$ and $f : Y \to X$ be given. We know $f^* S = \{ g : Z \to Y \st f \o g \in S\}$.
So we want to show
\[f^*S \in J(Y)\]
\[  \equiv \forall y \in Y . \exists Z . \exists g : Z \to Y \in f^* S . \exists z \in Z . g(z) = y\]
$$  \equiv \forall y \in Y . \exists W . \exists h : W \to Y . fh \in S . \exists w \in W . h(w) = y  \eqno(1) $$
and what we do know is
$$  \forall x \in X . \exists Z . \exists g : Z \to X \in S . \exists z \in Z . g(z) = x \eqno(2) $$
So let $y \in Y$ be given. Set $x$ in $(2)$ to $f(y)$, and let $Z$ and $g: Z \to X$ and $z$ be given.
We now know $g(z) = x$. In $(1)$, set $W$ to the pullback $Y \times_X Z$ of $f$ and $g$, and set $h = f^* g$.

\[\begin{tikzcd}
  Y \times_X Z \ar[r] \ar[d, "h"'] \pbck& Z \ar[d, "g"]\\
  Y  \ar[r, "f"'] & X \\
\end{tikzcd}\]
\end{enumerate}

\section{Oriented Cubes}

\def\inc{\triangleleft}
A cell in a cube is a partial substitution $\Gamma \prov \sigma$ of binary digits for some of the variables in $\Gamma$.
For example, a vertex of a cube is $x,y,z\prov[0/x][1/y][0/z]$ and a face of a cube is $x,y,z\prov [1/y]$. Lower
dimensional cells have more substitutions in them. A lower-dimensional cell is incident to a one-dimension-higher cell
if it contains one more substitution: the relation $\sigma \inc \rho$  is defined by
\[
\erule
{x\in \Gamma}
{\Gamma \prov \sigma[b/x] \inc \sigma }
\]

We aim to define two more relations, $\sigma \dns \rho$ (resp. $\sigma \ups \rho$), which indicate that $\sigma$
is in the domain (resp. codomain) of $\rho$. These two relations partition $\inc$: every face incident to a one-higher cell
is either in its domain or codomain.

We can index all three of these relations by $n$, the number of variables in the context.

\def\s{{*}}
\subsection{Maybe Not Substitutions}

The more concrete way of looking at this is with strings of $\{0,1,\s\}$. The vertices of the edge $\s$ are $0,1$.
The vertices of the face $\s\s$ are $00,01,10,11$. The edges are $0\s,1\s,\s0,\s1$. The domain and codomain relations $\dns$
and $\ups$ operate on pairs of strings of the same length such that the second one has one more $\s$.
We have $0 \dns \s$ and $1 \ups \s$. I think I want to assert
\[0\s \dns \s\s \qquad \s1 \dns \s\s \qquad \s0 \ups \s\s \qquad 1\s \ups \s\s \]
The main principle I want to impose goes like this. Let's say $f$ is a function on strings that inserts a binary
digit in a fixed place in a string. Then
\[
\erule
{s \dns t}
{f(s) \dns f(t)}
\qquad
\erule
{s \ups t}
{f(s) \ups f(t)}
\]
Now let's look at the cube $\s\s\s$. By the above principle, I infer all of
\[00\s \dns 0\s\s \qquad 0\s1 \dns 0\s\s \qquad 0\s0 \ups 0\s\s \qquad 01\s \ups 0\s\s \]
\[00\s \dns \s 0\s \qquad \s 01 \dns \s 0\s \qquad \s 00 \ups \s 0\s \qquad 10\s \ups \s 0\s \]
\[0\s 0\dns \s \s 0 \qquad \s10 \dns \s\s 0 \qquad \s00 \ups \s\s 0 \qquad 1\s 0\ups \s\s 0 \]
\[10\s \dns 1\s\s \qquad 1\s1 \dns 1\s\s \qquad 1\s0 \ups 1\s\s \qquad 11\s \ups 1\s\s \]
\[01\s \dns \s 1\s \qquad \s 11 \dns \s 1\s \qquad \s 10 \ups \s 1\s \qquad 11\s \ups \s 1\s \]
\[0\s 1\dns \s \s 1 \qquad \s11 \dns \s\s 1 \qquad \s01 \ups \s\s 1 \qquad 1\s 1\ups \s\s 1 \]

I notice that there are some cells that are {\em balanced} in the sense that they occur as a domain and a codomain,
and some that are {\em imbalanced}, occurring twice as domain or twice as codomain. The imbalanced (twice-domain) are
\[00\s \qquad 0\s 1 \qquad \s 11\]
The imbalanced (twice-codomain) are
\[11\s \qquad 1\s 0 \qquad \s 00\]
and the balanced are
\[10\s \qquad 01\s \qquad \s 01 \qquad \s 10 \qquad 0\s 0 \qquad 1\s 1\]

So there should be a unique partition of the faces of the cube such
that each half covers the domain-imbalanced edges once as domains, and
covers the codomain-imbalanced edges once as codomains, and covers
every other edge once as domain and once as codomain. This will also induce a partition of the balanced edges.

Let's start with the face $0\s\s$. This forces the edges $00\s$, (imbalanced)
 $0\s1\dns$ (also imbalanced) and $0\s0\ups$ (balanced) and
$01\s\ups$ (balanced). So we have to balance with faces $\s\s0$ and $\s1\s$. This should be sufficient; we end up with

\[00\s \dns 0\s\s \qquad 0\s1 \dns 0\s\s \qquad 0\s0 \ups 0\s\s \qquad 01\s \ups 0\s\s \]
\[0\s 0\dns \s \s 0 \qquad \s10 \dns \s\s 0 \qquad \s00 \ups \s\s 0 \qquad 1\s 0\ups \s\s 0 \]
\[01\s \dns \s 1\s \qquad \s 11 \dns \s 1\s \qquad \s 10 \ups \s 1\s \qquad 11\s \ups \s 1\s \]

Ok, so the two halves of the cube are $\{0\s\s,\s1\s,\s\s0\}$ and $\{1\s\s,\s0\s,\s\s1\}$. Can I convince myself the two
halves of the hypercube are
\[\dom = \{0\s\s\s,\s1\s\s,\s\s0\s,\s\s\s1\} , \cod = \{1\s\s\s,\s0\s\s,\s\s1\s,\s\s\s0\}\]
? Yeah, that seems right.

If so, I can conjecture a rule:
\begin{enumerate}
\item
  $s$ is in the domain of $t$ if $s$ arises from replacing the $n^{th}$ $\s$ in $t$ with $n \mathop\% 2$.
\item
  $s$ is in the codomain of $t$ if $s$ arises from replacing the $n^{th}$ $\s$ in $t$ with $(n+1) \mathop\% 2$.
\end{enumerate}

The `intersection' of any two cells $a,b$ within the domain (or within
the codomain) will be balanced --- in the domain of one of $a,b$ and
the codomain of the other. The `intersection` of a domain cell $d$ and a codomain cell $c$ will either
be in the domain of both $c,d$ or in the codomain of both $c,d$.

Ah, here's a simple definition: we define an orientation  relation $x \sim_b y$ where $x,y\in \{0,1,\s\}^*$.
Let $b,c$ range over $\{0,1\}$.
We assert rules:
\[
\erule
{}
{bx \sim_b \s x}
\qquad
\erule
{x \sim_b y}
{c x \sim_b c y}
\qquad
\erule
{x \sim_b y}
{\s x \sim_{\bar b} \s y}
\]

\subsection{Categorical Description}
\vfil\eject
\def\repl#1#2{[#1/\s_{#2}]}
Fix an $n$. We describe a higher-dimensional category that takes the shape of the $n$-dimensional cube.
Its objects will be binary strings that live in $\{0,1\}^n$. To describe the morphisms and higher cells we do the following.

Let $P_m$ be the set of strings over $\{0,1,\s\}^n$ such that exactly $m$ characters
in the string are $\s$. Obviously this partitions the set of strings of length $n$:
\[ \bigcup_{0 \le m \le n} P_m = \{0,1,\s\}^n \]
The set $P_m$ will be the `primitive' cells of dimension $m$, such that all other cells are compositions of them.
To define which compositions are valid we need to define directed cell boundaries.
When $b \in \{0,1\}$, and $s \in P_m$, and $0 \le i < m$, let $\repl b i s$ be the result of
replacing the $i^{th}$ occurrence (counting zero-indexed) of $\s$ in $s$ with the bit $b$.

We can define the {\em boundary} of a cell of dimension $m$,
which lives in $\Z[P_{m-1}]$.
If $c \in P_m$, we say
\[ \partial c = \sum_{i = 0}^m (-1)^i(\repl 1 i c - \repl 0 i c)\]
For example, $\partial (\s 1 \s) = 11\s - 01\s - \s11 + \s10$. This notion of boundary extends in an evident
way to subset $X \subseteq P_m$: we say
\[ \partial X = \sum_{x \in X} \partial x\]

Now we can define $C_m$, the set of cells of dimension $m$. We say $C_0 = P_0 = \{0,1\}^n$.
For higher dimensions, if $a, b \in C_m$, we say that an element of the homset $C_{m+1}[a, b]$ is
a subset $c \subseteq P_m$ such that $b - a = \partial c$.

Composition is always given by unions of sets, and identities morphisms are always realized by empty sets.
This means that associativity, interchange laws, and unit laws, come for free. What we need to verify
is that compositions even {\em exist} in the right homset,
which means checking the boundary conditions. But this is fairly easy.

To check vertical composition let two cells $\alpha \in C_m[x, y]$ and $\beta \in C_m[y,z]$ be given.
We know therefore that $\partial \alpha = y - x$ and $\partial \beta = z - y$. Therefore
\[\partial(\beta \o \alpha) = \partial(\beta \cup \alpha) = \partial\beta + \partial \alpha = z - y + y - x = z - x\]
so the composition is indeed a cell in $C_m[x,z]$.

To check horizontal composition let two cells $\alpha \in C_m[x_1, y_1]$ and $\beta \in C_m[x_2,y_2]$ be given,
so that $x_1,x_2$ are composable and $y_1,y_2$ are composable. We want to check that $\beta * \alpha$ is a cell in
$ C_m[x_2 \o x_1, y_2 \o y_1]$. So we need
\[ \partial(\beta * \alpha) = y_2 \o y_1 - x_2 \o x_1 \]
but
\[ \partial(\beta * \alpha) = \partial(\beta \cup \alpha) = \partial \beta + \partial \alpha  = y_2 - x_2 + y_1 - x_1\]
so we're done.

\subsection{Domains and Codomains}

If I take the square $\s\s$ and take the set of all its edges $\{0\s, 1\s, \s0, \s1\}$, and take its boundary,
I get $2 \cdot (11 - 00)$. In general if I take the boundary of the $n-1$-cells of the $n$-cube, I expect to get
two times some difference, and I can iterate on taking boundaries of those nonprimitive cells. Let's try to compute
the boundary of all faces in the cube. I think it is twice
\[(11\s + 1\s0 + \s00) - (00\s + 0\s1 + \s11) \]
Because look at $11\s$ in particular, and consider which faces it could have come from, and with which signs.
We have a positive amplitude $\s 1 \s \to 11 \s$ and positive $1\s1 \to 11\s$, because in both those situations it's
the $0^{th}$ $\s$ becoming a 1.

What's the boundary of all the volumes in the hypercube? I think it's
\[(11\s\s + 1\s0\s + 1\s\s1 + \s00\s + \s0\s1 + \s\s11)  -\]
\[(00\s\s + 0\s1\s + 0\s\s0 + \s11\s + \s1\s0 + \s\s00)  \]
In general I think it's
\[ \sum_{i \ne j \atop 0 \le i,j < n} \repl {A_{i}} i \repl {A_{j-i-1}} j \s^n  - \repl {\bar A_{i}} i \repl {\bar A_{j-i-1}} j \s^n\]
where $A_i = 1$ if $i \equiv 0 \pmod 2$ and $0$ otherwise.

\subsubsection{Second Boundaries}

What's the boundary of $(11\s + 1\s0 + \s00)$? It's $111 - 000$.

What's the boundary of $(11\s\s + 1\s0\s + 1\s\s1 + \s00\s + \s0\s1 + \s\s11)$?
It's
\[ (111 \s + 110\s + 11\s1 + 100\s + 10\s1 + 1\s11) \]
\[ {} - (11\s1 + 1\s01 + 1\s11 + \s001 + \s011 + \s111) \]
\[ {} - (110\s + 100\s + 10\s1 + 000\s + 00\s1 + 0\s11) \]
\[ {} + (11\s0 + 1\s00 + 1\s01 + \s000 + \s001 + \s011) \]
%
\[  = (111 \s + 11\s0 + 0\s11 + \s000)    -  (000 \s + 00\s1 + 1\s00 + \s111)\]

\subsubsection{Generalizing}

Let's say $P_m^n$ is the set of strings with length $n$ with exactly
$m$ $\s$s in them. What I'm interested in computing is $\partial^k P^n_{n-1}$.
I notice a pattern that
\[\partial P^2_1 = 2 \cdot (11 - 00)\]
\[\partial^2 P^3_2 = 2^2 \cdot (111 - 000)\]
\[\partial^3 P^4_3 = 2^3 \cdot (1111 - 0000)\]
so I conjecture
\[\partial^m P^{m+1}_m = 2^m \cdot (1^{m+1} - 0^{m+1})\]
If I write $\npart$ for $\partial/2$ then
\[\npart^{m-1} P^{m}_{m-1} = 1^{m} - 0^{m}\]
I think I can define a `star-insertion' operator $S$ such that
\[ S(b_1\cdots b_n) = (b_1\cdots b_n\s) +( b_1\cdots b_{n-1}\s \bar b_n) + \cdots  + (\s \bar b_1 \cdots \bar b_n) \]
for example
\[ S(000) = 000\s + 00\s1 + 0\s 11 + \s 111\]
In which case I conjecture
\[\npart^{k-1} P^{m}_{m-1} = S^{m -  k}(1^{k} - 0^{k})\]





\subsection{Somewhat more Careful Definitions}

Here's an inductive definition of $\partial$, writing $x$ for an arbitrary ternary string in
$\{0,1,\s\}^*$, writing
$b \in \{0,1\}$ and concatenation as $\cdot$ or juxtaposition, and $\epsilon$ for the empty string,
and $\null$ as the unit of the formal sum in $\Z[P^n_m]$. We can lift concatenation from an operation
$P^{n_1}_{m_1} \x P^{n_2}_{m_2} \to P^{n_1+n_2}_{m_1+m_2}$ to
an operation
\[\Z[P^{n_1}_{m_1}] \x \Z[P^{n_2}_{m_2}] \to \Z[P^{n_1+n_2}_{m_1+m_2}]\]
 in the evident linear way.


\[ \partial (\s  x) = 1x - 0x - \s \cdot \partial x\]
\[ \partial (b  x) = b \cdot \partial x\]
\[ \partial \epsilon = \null\]

For example, $\partial 101101 = \null$ and
\[\partial 101\s0\s = 10110\s - 10100\s - 101\s01 + 101\s00\]

Now let's try to define star-insertion inductively from the right.

\[S(x \s) = (S x)\s \]
\[S(x b) = x b \s + (S x) \bar b \]
\[S\epsilon = \s \]
\end{document}
