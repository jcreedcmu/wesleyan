\documentclass{article}
\usepackage[tmargin=0.15in, bmargin=0.15in]{geometry}
\input{theorem}
\input{prooftree}
\usepackage{relsize}
\usepackage{stmaryrd}
\usepackage{latexsym}
\usepackage{yfonts}
\usepackage{amsmath}
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
\usepackage{tikz}
\usetikzlibrary{calc,arrows,cd,decorations.pathreplacing}
\usetikzlibrary{decorations.pathmorphing}
\usepackage{tcolorbox}
\tcbuselibrary{breakable}
\usepackage{listings}
\lstset{basicstyle=\ttfamily\footnotesize,breaklines=true}

\def\zed{\emptyset}
\def\lint{{\textstyle\int}}
\def\isopen{\textcolor{orange}{\mathlarger{\mathlarger{\mathlarger{\textbf ?}}}}}
\def\isok{\textcolor{green}{\mathlarger{\mathlarger{\mathlarger{\checkmark}}}}}
\def\isbad{\textcolor{red}{\mathlarger{\mathlarger{\mathlarger{\x}}}}}
\def\chave{\eqno \textcolor{blue}{\hbox{have}}}
\def\cset{\eqno \textcolor{green}{\hbox{set}}}
\def\cwant{\eqno \textcolor{orange}{\hbox{want}}}
\def\gol{\sqsubset}
\def\gor{\sqsupset}

\def\sp{\bullet}
\def\ot{\leftarrow}
\def\prequiv{\dashv\vdash}
\def\fdom{{\mathbf{d}f}}
\def\fcod{{\mathbf{e}f}}
\def\fidom{\mathbf{\bar d}f}
\def\ficod{\mathbf{\bar e}f}

\def\thn{\mathrel|}
\def\coe{\mathsf{coe}}
\def\bpush{\mathbf{push}}
\def\bpull{\mathbf{pull}}

\definecolor{blu}{rgb}{0.1,0.5,1}
\definecolor{orng}{rgb}{1,0.5,0.3}

\def\wo{\setminus}
\def\fA{\mathsf{A}}
\def\fC{\mathsf{C}}
\def\fX{\mathsf{X}}
\def\ff{\mathsf{f}}
\def\fm{\mathsf{m}}
\def\rspan{\mathsf{Span}}
% \def\El#1{\mathsf{El}({#1})}
\def\El#1{\ulcorner{#1}\urcorner}
\def\U{\mathsf{U}}
\def\uu{\mathsf{u}}
\def\uni{\U}
\def\mor#1#2{#1 \to \underline{#2}}

\def\ridp{\mathsf{idp}}
\def\ssem#1{\langle\!\langle{#1}\rangle\!\rangle}

\definecolor{lred}{rgb}{0.95,0.8,0.8}
\definecolor{cyan}{rgb}{0.80,0.95,0.95}
\definecolor{lorange}{rgb}{0.95,0.90,0.80}
\definecolor{bluegray}{rgb}{0.6,0.6,0.85}
\definecolor{lgray}{gray}{0.8}
\newtcolorbox{declbox}{colframe=lred,colback=lred,grow to right by=-10mm,grow to left by=-10mm,
boxrule=0pt,boxsep=0pt,breakable}
\newtcolorbox{thmbox}{colframe=cyan,colback=cyan,grow to right by=-10mm,grow to left by=-10mm,
boxrule=0pt,boxsep=0pt,breakable}
\newtcolorbox{defnbox}{colframe=lorange,colback=lorange,grow to right by=-10mm,grow to left by=-10mm,
boxrule=0pt,boxsep=0pt,breakable}
\newtcolorbox{tangentbox}{colframe=lgray,colback=lgray,grow to right by=-10mm,grow to left by=-10mm,
boxrule=0pt,boxsep=0pt,breakable}

\input{linear}
\def\rpath#1{[#1]}
\def\rfst{\mathsf{fst}\,}
\def\rsnd{\mathsf{snd}\,}
\def\bunfold{\mathbf{unfold}}
\def\bfold{\mathbf{fold}}
\def\susp#1{\langle {#1} \rangle}
\def\ssusp#1{\langle\!\langle {#1} \rangle\!\rangle}
\def\dto{\mathrel{\dot\to}}
\def\dns{{\downarrow}}
\def\ups{{\uparrow}}
\def\sprov{\Vdash}
\def\signat{{\color{red}\Sigma}}
\def\ep#1{\underline{#1}}
\def\wat{\mathbin{@}}
\def\wwat{\mathbin{\underline\wat}}
\def\cn{{:}}
\def\dv{{\div}}
\def\ww{{\mathsf w}}
\def\base{{\textfrak b}}

\def\N{{\mathbb N}}
\def\Z{{\mathbb Z}}
\def\munit{I}
\def\tt{{\mathsf t}}
\def\ii{{\mathbb I}}
\def\T{\mathbb{T}}
\def\tw{\mathsf{Tw}}
\def\sw#1{^{#1}_{#1}}
\def\TP{\mathbf{TPre}}
\def\pp{\textsf{\textbf p}}
\def\nn{{\mathsf n}}
\def\PP{\textsf{\textbf P}}
\def\NN{\textsf{\textbf N}}
\def\zz{{\mathsf z}}
\def\sem#1{[\![#1]\!]}
\def\usem#1{\lceil\!\!\lceil{#1}\rceil\!\!\rceil}
\def\zem#1{\langle\!\langle#1\rangle\!\rangle}
\def\col#1{{\mathsf{C}}_{#1}}
\def\lax{\mathop\bigcirc}
\def\rjust{\mathsf{just}}
\def\rcvt{\mathsf{cvt}}
\def\rtype{\mathsf{type}}
\def\rdtype{\mathsf{disc}}
\def\rkind{\mathsf{kind}}
\def\rmode{\mathsf{mode}}
\def\rprel{\mathbf{Prel}}
\def\rrfam{\mathbf{Rfam}}
\def\rset{\mathbf{Set}}
\def\rfinset{\mathbf{FinSet}}
\def\rrel{\mathbf{Rel}}
\def\rcat{\mathbf{Cat}}
\def\rfam{\mathbf{Fam}}
\def\binj{\mathbf{inj}}
\def\rid{\mathsf{id}}
\def\rtrue{\mathrel\mathrm{true}}
\def\pbck{\ar[dr, phantom, pos=0, "\lrcorner"]}
\def\bpbck{\ar[ddrr, phantom, pos=0, "\lrcorner"]}
\def\erule#1#2{\begin{prooftree}#1\justifies #2\end{prooftree}}
\def\lpar{\bindnasrepma}
\def\lamp{\binampersand}
\def\btwo{\mathbf{2}}
\def\bone{\mathbf{1}}

\newarrow {Equiv} =====
\def\FinSet{\mathbf{FinSet}}
\def\x{\times}
\def\maps{\ar[dd,mapsto,shorten <=2em, shorten >=2em]}
\def\mapt{\ar[ddd,mapsto,shorten <=2em, shorten >=2em]}
\def\A{\mathbf{A}}
\def\B{\mathbf{B}}
\def\C{\mathbf{C}}
\def\G{\mathbf{G}}
\def\D{\mathbf{D}}
\def\DD{\mathbb{D}}
\def\E{\mathbf{E}}
\def\M{\mathbf{M}}
\def\pair#1#2{\langle#1,#2\rangle}
\def\ltri{{\lhd}}
\def\rtri{{\rhd}}
\def\tri{\rhd}
\def\ll{{<}}
\def\rr{{>}}
\def\cc{\mathsf{c}}
\def\dd{\mathsf{d}}
\def\o{\circ}
\def\rctx{\,\mathsf{ctx}}
\def\rdctx{\,\mathsf{dctx}}
\def\del{\partial}
\def\also#1{\ \textcolor{blue}{\celse #1}}
\newcounter{nodemaker}
\setcounter{nodemaker}{0}
\def\twocell#1#2{%
  \global\edef\mynodeone{twocell\arabic{nodemaker}}%
  \stepcounter{nodemaker}%
  \global\edef\mynodetwo{twocell\arabic{nodemaker}}%
  \stepcounter{nodemaker}%
  \ar[#1,phantom,shift left=3,""{name=\mynodeone}]%
  \ar[#1,phantom,shift right=3,""'{name=\mynodetwo}]%
  \ar[Rightarrow,#2,from=\mynodeone,to=\mynodetwo]%
}
\def\twocellswap#1#2{%
  \global\edef\mynodeone{twocell\arabic{nodemaker}}%
  \stepcounter{nodemaker}%
  \global\edef\mynodetwo{twocell\arabic{nodemaker}}%
  \stepcounter{nodemaker}%
  \ar[#1,phantom,shift right=3,""{name=\mynodeone}]%
  \ar[#1,phantom,shift left=3,""'{name=\mynodetwo}]%
  \ar[Rightarrow,#2,from=\mynodeone,to=\mynodetwo]%
}
\def\maps{\ar[dd,mapsto,shorten <=2em, shorten >=2em]}
\author{Jason Reed}
\definecolor{fib}{HTML}{ff7f00}
\definecolor{green}{HTML}{007f00}
\definecolor{red}{HTML}{df3f3f}
\definecolor{opfib}{HTML}{007fff}

% For lightening colors I used
% http://trycolors.com/ 6 parts white to 1 part color
\definecolor{opfibl}{HTML}{DBEDFF}
\definecolor{greenl}{HTML}{DBEDDB}
\definecolor{redl}{HTML}{FAE4E4}
\def\njudge#1{\fcolorbox{opfib}{white}{#1}}
\def\nrule#1{\fcolorbox{white}{opfibl}{#1}}
\def\neqn#1{\fcolorbox{white}{redl}{#1}}



\def\judge#1{\vskip 2em\noindent \njudge{$#1$}\vskip 0.5em\noindent}
\def\rule#1{\vskip 2em \noindent \nrule{$#1$}\vskip 0.5em\noindent}
\def\eqn#1{\vskip 2em \noindent \neqn{$#1$}\vskip 0.5em\noindent}
\def\prof{\nrightarrow}
\def\tensor{\otimes}
\def\htensor{\mathrel{\hat\otimes}}
\def\lol{\multimap}
\def\hlol{\mathrel{\hat\multimap}}
\def\wtf{{\color{red}???}}

\def\re{\mathbf{E}}
\def\sh{\sharp}
\def\shp{\mathrel{\sharp}}
\def\zero{\texttt{0}}
\begin{document}

\def\
\tikzset{
   commutative diagrams/.cd,
   arrow style=tikz,
   diagrams={>=stealth}}

\def\doubs#1{{}^{{#1}^\op}_{\x {#1}}}
\def\doub#1{{#1}^\op \x {#1}}

\section{Collecting Examples, Again}
$\forall$ means end and $\exists$ means coend. The variable
$a$ is free in the top and bottom of every rule, and there is an implicit end over it.
Rules marked $\star$ are newly proved below in this document.

\[
\erule
{ F \sw {a a}}
{ \exists b. F \sw {a b}}
\isbad
\qquad
\erule
{ F^a_a \to G\sw a}
{\left(\forall b. F^b_b\right) \to  G\sw a}
\isbad
\]
\[
\erule
{ F^a_{a t\sw a} \x H^{a t\sw a}_a}
{ \exists b. F^a_{a b} \x H^{a b}_a}
\isopen
\qquad
\erule
{  F^{a}_{a t^a_a} \x H^{a t^a_a}_{a } \to G^a_a}
{ \left(\forall b. F^a_{ab} \x H^{a b}_{a }\right) \to G^a_a}
\isok
\]
\[
\erule
{ F^a_{a t_a} \x H^{a t_a}_a}
{ \exists b. F^a_{a b} \x H^{a b}_a}
\isok
\qquad
\erule
{ F^a_{a t\sw a} }
{ \exists b. F^a_{a b}}
\isok
\]
\[
\erule
{\using \isok}
{ \left(\forall b. F\sw {a b}\right) \to  F\sw {a t\sw a}}
\qquad
\erule
{ \using \isok \star}
{ F\sw {a t\sw a} \to \exists b. F\sw {a b} }
\]
\[
\erule
{G\sw a \to H^a_{at\sw a}
\using \isok  \star}
{  F\sw {a t\sw a} \x G^{a}_{a} \to \exists b. F\sw {a b}\x H^a_{ab} }
\]


Counterexample to the first $\isbad$ is the ``$\lrcorner$''-shaped diagram in 6.6.2 of \texttt{2018-07-04}. Counterexample to the second is $F = 0111$ and $G = 0112$.
I was going to add
\[
\erule
{ F^{a t_a}_{a t_a}}
{ \exists b. F^{a b}_{a b} }
\isbad
\]
as an open example, but I realize it's a special case of the first counterexample,
with $t$ the identity functor.

\subsection{Existential Version of Identity}
\[
\erule
{\using \isok}
{ F\sw {a t\sw a} \to \exists b. F\sw {a b} }
\]
We are trying to make $M_d : F\sw {d t\sw d} \to \exists b. F\sw {d b} $, so
we set $M_d (x) = \pair {t^d_d} x$. Want to check the end-property
that
\[(\exists b . F_f) \o M_d \o  F_{\cdot t^f}^{f t_f} = (\exists b . F^f) \o M_e \o F_{ft_f}^{\cdot t^f} \]
i.e.
\[ (x : F^{et^e_d}_{dt^d_e}) \to \pair {t^d_d} {F_{f t^f}^{f t_f} x} = \pair {t^e_e} {F_{f t_f}^{f t^f} x} : \exists b . F^{db}_{eb}\]
for which it would suffice
\[ (y : F^{dt^e_d}_{et^d_e}) \to \pair {t^d_d} {F_{\cdot t^f}^{\cdot t_f} y} = \pair {t^e_e} {F_{\cdot t_f}^{\cdot t^f} y} : \exists b . F^{db}_{eb}\]
and I can reason
\[\begin{tikzcd}
{[eeee]}\ar[from=dd]  &&\exists b . F^{db}_{eb}\ar[from=dl, "\iota"']\ar[from=dr, "\iota"]\ar[from=ll, "\iota"']\ar[from=rr, "\iota"] &&  {[dddd]}\ar[from=dd]\\
 & {[dede]}\ar[from=dr]\ar[from=dl] && {[eded]}\ar[from=dr]\ar[from=dl] \\
 {[eede]} \ar[from=rr]&& {[edde]} && {[eddd]}\ar[from=ll]
\end{tikzcd}\]
Where $[ijk\ell]$ means $F^{d t^i_j}_{e t^k_\ell}$.

\subsection{An Important Case For Existentials and Products}
\[
\erule
{G\sw a \to H^a_{at\sw a}
\using \isok}
{  F\sw {a t\sw a} \x G^{a}_{a} \to \exists b. F\sw {a b}\x H^a_{ab} }
\]
We have $L_d : G^d_d \to H^d_{dt\sw d}$. We know the end-property
\[H_{ft_f} \o L_d \o  G^f = H^f_{t^f} \o L_e \o G_f \chave\]

We are trying to make $M_d :  F\sw {d t\sw d} \x G\sw d \to \exists b. F\sw {d b} \x H^d_{db}$, so
we set
\[M_d (x, z) = \pair {t^d_d} {x, L_d(z)}\]
 Want to check the end-property
that
\[(\exists b . F_f \x H_f) \o M_d \o  (F_{\cdot t^f}^{f t_f} \x G^f) = (\exists b . F^f \x H^f) \o M_e \o (F_{ft_f}^{\cdot t^f} \x G_f) \]
i.e.
\[ (x : F^{et^e_d}_{dt^d_e}) (z : G^e_d) \to \pair {t^d_d} {F_{f t^f}^{f t_f} x, H_f L_dG^f z}
= \pair {t^e_e} {F_{f t_f}^{f t^f} x, H^fL_eG_f z} \cwant\]
\[: \exists b . F^{db}_{eb} \x H^{d}_{eb} \]

I appear to be blocked on applying the {\em end} property that I have,
for lack of $t^f$/$t_f$ appearing here in the rightmost component of the tuple. However,
maybe I can exploit the coend property since $H$ is covariant in $b$. I know
the coend property of $\exists b .  C^b_b$ tells me that for any $s : u \to v$
and $K : C^v_u$ that
\[ \pair u {C^s K} = \pair v {C_s K}\]
so the coend property for $\exists b . F\sw{ab} \x H^a_{ab}$ tells me that for any
$s : u \to v$ and $K : F^{av}_{au} \x H^a_{au}$ that
\[ \pair u {F^{\cdot s} K^1, K^2} = \pair v {F_{\cdot s} K^1, H_{\cdot s} K^2}\]
That unadorned $K^2$ there is the thing giving me hope! So let me guess that I want
$u = t^d_d$ and $v = t^d_e$ and
$s = t_f : t\sw d \to t^d_e$ and $K^1 = F^{f}_{ft^f} x$ and $K^2 = H_f L_d G^f z$.
Then I get
\[ (x : F^{et^e_d}_{dt^d_e}) (z : G^e_d) \to \pair {t^d_d} {F_{f t^f}^{f t_f} x, H_f L_dG^f z}
= \pair {t^d_e} {F_{f t^f_f}^{f } x, H_{f t_f} L_dG^f z} \]
\[: \exists b . F^{db}_{eb} \x H^{d}_{eb}\]
and {\em now} we can use the end-property we have to see this is the same as
\[ (x : F^{et^e_d}_{dt^d_e}) (z : G^e_d) \to \pair {t^d_d} {F_{f t^f}^{f t_f} x, H_f L_dG^f z}
= \pair {t^d_e} {F_{f t^f_f}^{f } x, H^{f}_{\cdot t^f} L_eG_f z} \chave \]
\[: \exists b . F^{db}_{eb} \x H^{d}_{eb}\]
and we can also use the {\em coend} property with $u = t^e_e$ and $v = t^d_e$
and $s = t^f : t\sw e \to t^d_e$
and $K^1 = F^f_{f t_f} x$ and $K^2 = H^f L_e G_f z$ to see
\[ (x : F^{et^e_d}_{dt^d_e}) (z : G^e_d) \to
 \pair {t^e_e} {F_{f t_f}^{f t^f} x, H^f L_eG_f z}
= \pair {t^d_e} {F_{f t^f_f}^{f } x, H^{f}_{\cdot t^f} L_eG_f z} \chave \]
\[: \exists b . F^{db}_{eb} \x H^{d}_{eb}\]
and combining the two `have's I get my goal by transitivity.
\end{document}
